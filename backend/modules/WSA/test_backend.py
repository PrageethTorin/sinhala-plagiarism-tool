import requests

URL = "http://127.0.0.1:8000/api/check-wsa"

def run_combined_test():
    test_paragraph = (
        "‡∂∏‡∑è‡∂±‡∑Ä,‡∑Ä‡∂Ç‡∑Å ‡∂¢‡∂±‡∂±‡∂∫ ‡∂∫‡∂±‡∑î ‡∂∫‡∂∏‡∑ä ‡∑É‡∂∏‡∑è‡∂¢ ‡∂¥‡∑É‡∑î‡∂∂‡∑í‡∂∏‡∂ö ‡∂¢‡∑ì‡∑Ä‡∂≠‡∑ä ‡∑Ä‡∂± ‡∂¥‡∑î‡∂Ø‡∑ä‡∂ú‡∂Ω ‡∂ö‡∂´‡∑ä‡∂©‡∑è‡∂∫‡∂∏‡∂ö‡∑ä ‡∂≠‡∂∏‡∂±‡∑ä‡∂ß‡∂∏ ‡∑É‡∑î‡∑Ä‡∑í‡∑Å‡∑ö‡∑Ç‡∑ì ‡∑Ä‡∑ñ ‡∂¢‡∂±‡∑Ä‡∑è‡∂ª‡∑ä‡∂ú‡∑í‡∂ö ‡∑Ñ‡∑ê‡∂≥‡∑î‡∂±‡∑î‡∂∏‡∂ö‡∑ä ‡∑É‡∑ä‡∂Æ‡∑è‡∂¥‡∑í‡∂≠ ‡∂ö‡∂ª ‡∂ú‡∂±‡∑ä‡∂±‡∑è ‡∂ö‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∑è‡∑Ä‡∂Ω‡∑í‡∂∫‡∂ö‡∑ä ‡∂Ω‡∑ô‡∑É ‡∑Ä‡∑í‡∑É‡∑ä‡∂≠‡∂ª ‡∂ö‡∑Ö ‡∑Ñ‡∑ê‡∂ö‡∑í‡∂∫. ‡∂ä. ‡∂¥‡∑ì. ‡∂≠‡∑ú‡∂∏‡∑ä‡∂¥‡∑ä‡∑É‡∂±‡∑ä‡∂ú‡∑ö ‡∂Ö‡∂Ø‡∑Ñ‡∑É ‡∂Ö‡∂±‡∑î‡∑Ä, ‡∂∏‡∑ô‡∂∏ ‡∂ö‡∑ä‚Äç‡∂ª‡∑í‡∂∫‡∑è‡∑Ä‡∂Ω‡∑í‡∂∫ ‡∂≠‡∑î‡∑Ö‡∑í‡∂±‡∑ä ‡∑Ä‡∑í‡∑Ä‡∑í‡∂∞ ‡∂¢‡∂± ‡∂ö‡∂´‡∑ä‡∂©‡∑è‡∂∫‡∂∏‡∑ä ‡∂≠‡∂∏ ‡∂Ö‡∂±‡∂±‡∑ä‚Äç‡∂∫‡∂≠‡∑è‡∑Ä‡∂∫ ‡∂ú‡∑ú‡∂©‡∂±‡∂ü‡∑è ‡∂ú‡∂±‡∑í‡∂∏‡∑í‡∂±‡∑ä ‡∂â‡∂≠‡∑í‡∑Ñ‡∑è‡∑É‡∂∫‡∑ö ‡∑É‡∑ä‡∂Æ‡∑è‡∂±‡∂∫‡∂ö‡∑ä ‡∂Ω‡∂∂‡∑è ‡∂ú‡∂±‡∑í‡∂≠‡∑í. ‡∂ë‡∑Ñ‡∑í ‡∂¥‡∑ä‚Äç‡∂ª‡∂≠‡∑í‡∂µ‡∂Ω‡∂∫‡∂ö‡∑ä ‡∂Ω‡∑ô‡∑É, ‡∂ö‡∂Ω‡∑í‡∂±‡∑ä ‡∂â‡∂≠‡∑í‡∑Ñ‡∑è‡∑É‡∑í‡∂ö ‡∑É‡∂≠‡∑ä‚Äç‡∂∫‡∂∫‡∂±‡∑ä ‡∂Ω‡∑ô‡∑É ‡∑É‡∑ê‡∂Ω‡∂ö‡∑î‡∂´‡∑î ‡∑Ä‡∑ñ ‡∂á‡∂≠‡∑ê‡∂∏‡∑ä ‡∂¥‡∑ê‡∂ª‡∂´‡∑í ‡∂ö‡∂Æ‡∑è ‡∑Ä‡∂ª‡∑ä‡∂≠‡∂∏‡∑è‡∂±‡∂∫‡∑ö ‡∂∂‡∑ú‡∑Ñ‡∑ù ‡∑Ä‡∑í‡∂Ø‡∑ä‡∑Ä‡∂≠‡∑ä‡∑Ñ‡∑î ‡∑Ä‡∑í‡∑É‡∑í‡∂±‡∑ä ‡∂¢‡∂±‡∂¥‡∑ä‚Äç‡∂ª‡∑Ä‡∑è‡∂Ø ‡∂Ω‡∑ô‡∑É ‡∂±‡∑ê‡∑Ä‡∂≠ ‡∂Ö‡∂ª‡∑ä‡∂Æ ‡∂Ø‡∑ê‡∂ö‡∑ä‡∑Ä‡∑ì‡∂∏‡∂ß ‡∂¥‡∑ô‡∑Ö‡∂π‡∑ì ‡∂á‡∂≠."
   )

    try:
        response = requests.post(URL, json={"text": test_paragraph})
        data = response.json()
        
        if 'style_change_ratio' in data:
            print("="*80)
            print("‚úÖ DUAL-METRIC RESEARCH ANALYSIS (STYLE & INTERNET DISCOVERY)")
            print(f"üìä Style Change Ratio: {data['style_change_ratio']}%")
            print(f"üîó BEST SAME IDEA URL: {data.get('matched_url', 'No source found')}")
            print("-" * 80)
            print(f"{'ID':<4} | {'Len':<5} | {'TTR %':<10} | {'Status'}")
            print("-" * 60)
            
            for s in data['sentence_map']:
                status = "üö© STYLE SHIFT" if s['is_outlier'] else "‚úì Baseline"
                print(f"S{s['id']:<3} | {s['length']:<5} | {s['lexical_ttr']:<10} | {status}")
            print("-" * 80)
    except Exception as e:
        print(f"‚ùå Connection Error: {e}")

if __name__ == "__main__":
    run_combined_test()